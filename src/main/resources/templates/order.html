<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
<meta charset="UTF-8">
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<title>订单管理</title>
<link href="../AmazeUI-2.4.2/assets/css/admin.css" rel="stylesheet"
	type="text/css">
<link href="../AmazeUI-2.4.2/assets/css/amazeui.css" rel="stylesheet"
	type="text/css">

<link href="../css/personal.css" rel="stylesheet" type="text/css">
<link href="../css/orstyle.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="../basic/js/jquery-1.7.min.js"></script>
<script src="../AmazeUI-2.4.2/assets/js/jquery.min.js"
	type="text/javascript"></script>
<script src="../AmazeUI-2.4.2/assets/js/amazeui.js"></script>
</head>
<body>
	<div th:replace="header::header"></div>
	<div class="nav-table">
		<div class="long-title">
			<span class="all-goods">全部分类</span>
		</div>
	</div>
	<b class="line"></b>
	<div class="center">
		<div class="col-main">
			<div class="main-wrap">

				<div class="user-order">

					<!--标题 -->
					<div class="am-cf am-padding">
						<div class="am-fl am-cf">
							<strong class="am-text-danger am-text-lg">订单管理</strong> / <small>Order</small>
						</div>
					</div>
					<hr />

					<div class="am-tabs am-tabs-d2 am-margin" data-am-tabs>

						<ul class="am-avg-sm-5 am-tabs-nav am-nav am-nav-tabs">
							<li class="am-active"><a href="#tab1">所有订单</a></li>
							<li><a href="#tab2">待付款</a></li>
							<li><a href="#tab3">待发货</a></li>
							<li><a href="#tab4">待收货</a></li>
							<li><a href="#tab5">已收货</a></li>
						</ul>

						<div class="am-tabs-bd">
							<div class="am-tab-panel am-fade am-in am-active" id="tab1">
								<div class="order-top">
									<div class="th th-item">
										<td class="td-inner">商品</td>
									</div>
									<div class="th th-price">
										<td class="td-inner">单价</td>
									</div>
									<div class="th th-number">
										<td class="td-inner">数量</td>
									</div>
									<div class="th th-operation">
										<td class="td-inner">商品操作</td>
									</div>
									<div class="th th-amount">
										<td class="td-inner">合计</td>
									</div>
									<div class="th th-status">
										<td class="td-inner">交易状态</td>
									</div>
									<div class="th th-change">
										<td class="td-inner">交易操作</td>
									</div>
								</div>

								<div class="order-main" th:each="allOrder:${allOrders}">
									<div class="order-list">
										<div class="order-status5">
											<div class="order-title">
												<div class="dd-num">
													订单编号：<a href="javascript:;" th:text="${allOrder.id}">1601430</a>
												</div>
												<span th:text="'成交时间：'+${allOrder.createDate}">成交时间：2015-12-20</span>
												<!--    <em>店铺：小桔灯</em>-->
											</div>
											<div class="order-content">
												<div class="order-left">
													<ul class="item-list">
														<li class="td td-item">
															<div class="item-pic">
																<a href="#" class="J_MakePoint"> 
																	<img th:src="@{${allOrder.commodity.getImgUrl()}}" class="itempic J_ItemImg">
																</a>
															</div>
															<div class="item-info">
																<div class="item-basic-info">
																	<a href="#">
																		<p th:text="${allOrder.commodity.getProductName()}">美康粉黛醉美唇膏 持久保湿滋润防水不掉色</p>
																		<p class="info-little">
																			颜色：随机<br />包装：一盒装
																		</p>
																	</a>
																</div>
															</div>
														</li>
														<li class="td td-price">
															<div class="item-price" th:text="'￥'+${allOrder.commodity.getPrice()}">333.00</div>
														</li>
														<li class="td td-number">
															<div class="item-number">
																<span th:text="${allOrder.count}"></span>
															</div>
														</li>
														<li class="td td-operation">
															<div class="item-operation"></div>
														</li>
													</ul>
												</div>
												<div class="order-right">
													<li class="td td-amount">
														<div class="item-amount" th:text="'合计：'+${allOrder.total_fee}">
															合计：676.0	
														</div>
													</li>
													<div class="move-right">
														<li class="td td-status">
															<div></div>
														</li>
														<li class="td td-change">
															<!-- <div class="am-btn am-btn-danger anniu"></div> -->
														</li>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="am-tab-panel am-fade" id="tab2">

								<div class="order-top">
									<div class="th th-item">
										<td class="td-inner">商品</td>
									</div>
									<div class="th th-price">
										<td class="td-inner">单价</td>
									</div>
									<div class="th th-number">
										<td class="td-inner">数量</td>
									</div>
									<div class="th th-operation">
										<td class="td-inner">商品操作</td>
									</div>
									<div class="th th-amount">
										<td class="td-inner">合计</td>
									</div>
									<div class="th th-status">
										<td class="td-inner">交易状态</td>
									</div>
									<div class="th th-change">
										<td class="td-inner">交易操作</td>
									</div>
								</div>

								<div class="order-main" th:each="order:${noPay}">
									<div class="order-list">
										<div class="order-status1">
											<div class="order-title">
												<div class="dd-num">
													订单编号：<a href="javascript:;" th:text="${order.id}">1601430</a>
												</div>
												<span th:text="'成交时间：'+${order.createDate}">成交时间：2015-12-20</span>
												<!--    <em>店铺：小桔灯</em>-->
											</div>
											<div class="order-content">
												<div class="order-left">
													<ul class="item-list">
														<li class="td td-item">
															<div class="item-pic">
																<a href="#" class="J_MakePoint"> 
																	<img th:src="@{${order.commodity.getImgUrl()}}" class="itempic J_ItemImg">
																</a>
															</div>
															<div class="item-info">
																<div class="item-basic-info">
																	<a href="#">
																		<p th:text="${order.commodity.getProductName()}">美康粉黛醉美唇膏 持久保湿滋润防水不掉色</p>
																		<p class="info-little">
																			颜色：随机 <br />包装：裸装
																		</p>
																	</a>
																</div>
															</div>
														</li>
														<li class="td td-price">
															<div class="item-price" th:text="'￥'+${order.commodity.getPrice()}">333.00</div>
														</li>
														<li class="td td-number">
															<div class="item-number">
																<span th:text="${order.count}" id="count"></span>
															</div>
														</li>
														<li class="td td-operation">
															<div class="item-operation"></div>
														</li>
													</ul>
												</div>
												<div class="order-right">
													<li class="td td-amount">
														<div class="item-amount" th:text="'合计：'+${order.total_fee}">
															合计：676.00
															
														</div>
													</li>
													<div class="move-right">
														<li class="td td-status">
															<div class="item-status">
																<p class="Mystatus">等待买家付款</p>
																<p class="order-info">
																	<a href="#" class="delete" th:value=${order.id}>取消订单</a>
																</p>

															</div>
														</li>
														<li class="td td-change"><a href="#">
																<div class="am-btn am-btn-danger anniu" id="LikBuy" th:value="${order.commodity.getProductId()}">一键支付</div>
														</a></li>
													</div>
												</div>

											</div>
										</div>
									</div>

								</div>
							</div>
							<div class="am-tab-panel am-fade" id="tab3">
								<div class="order-top">
									<div class="th th-item">
										<td class="td-inner">商品</td>
									</div>
									<div class="th th-price">
										<td class="td-inner">单价</td>
									</div>
									<div class="th th-number">
										<td class="td-inner">数量</td>
									</div>
									<div class="th th-operation">
										<td class="td-inner">商品操作</td>
									</div>
									<div class="th th-amount">
										<td class="td-inner">合计</td>
									</div>
									<div class="th th-status">
										<td class="td-inner">交易状态</td>
									</div>
									<div class="th th-change">
										<td class="td-inner">交易操作</td>
									</div>
								</div>

								<div class="order-main" th:each="order1:${pendingDelivery}">
									<div class="order-list">
										<div class="order-status2">
											<div class="order-title">
												<div class="dd-num">
													订单编号：<a href="javascript:;" th:text="${order1.id}">1601430</a>
												</div>
												<span th:text="'成交时间:'+${order1.createDate}">成交时间：2015-12-20</span>
												<!--    <em>店铺：小桔灯</em>-->
											</div>
											<div class="order-content">
												<div class="order-left">
													<ul class="item-list">
														<li class="td td-item">
															<div class="item-pic">
																<a href="#" class="J_MakePoint"> 
																	<img th:src="@{${order1.commodity.getImgUrl()}}" class="itempic J_ItemImg">
																</a>
															</div>
															<div class="item-info">
																<div class="item-basic-info">
																	<a href="#">
																		<p th:text="${order1.commodity.getProductName()}">美康粉黛醉美唇膏 持久保湿滋润防水不掉色</p>
																		<p class="info-little">
																			颜色：随机<br />包装：裸装
																		</p>
																	</a>
																</div>
															</div>
														</li>
														<li class="td td-price">
															<div class="item-price" th:text="'￥'+${order1.commodity.getPrice()}">333.00</div>
														</li>
														<li class="td td-number">
															<div class="item-number">
																<span th:text="${order1.count}"></span>
															</div>
														</li>
														<li class="td td-operation">
															<div class="item-operation">
																<a href="refund.html">退款</a>
															</div>
														</li>
													</ul>
												</div>
												<div class="order-right">
													<li class="td td-amount">
														<div class="item-amount" th:text="'合计：'+${order1.total_fee}">
															合计：676.00
														</div>
													</li>
													<div class="move-right">
														<li class="td td-status">
															<div class="item-status">
																<p class="Mystatus">买家已付款</p>
															</div>
														</li>
														<li class="td td-change">
															<div class="am-btn am-btn-danger anniu">提醒发货</div>
														</li>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="am-tab-panel am-fade" id="tab4">
								<div class="order-top">
									<div class="th th-item">
										<td class="td-inner">商品</td>
									</div>
									<div class="th th-price">
										<td class="td-inner">单价</td>
									</div>
									<div class="th th-number">
										<td class="td-inner">数量</td>
									</div>
									<div class="th th-operation">
										<td class="td-inner">商品操作</td>
									</div>
									<div class="th th-amount">
										<td class="td-inner">合计</td>
									</div>
									<div class="th th-status">
										<td class="td-inner">交易状态</td>
									</div>
									<div class="th th-change">
										<td class="td-inner">交易操作</td>
									</div>
								</div>

								<div class="order-main" th:each="order2:${noReceive}">
									<div class="order-list">
										<div class="order-status3">
											<div class="order-title">
												<div class="dd-num">
													订单编号：<a href="javascript:;" th:text="${order2.id}" id="orderid">1601430</a>
												</div>
												<span th:text="'成交时间:'+${order2.createDate}">成交时间：2015-12-20</span>
												<!--    <em>店铺：小桔灯</em>-->
											</div>
											<div class="order-content">
												<div class="order-left">
													<ul class="item-list">
														<li class="td td-item">
															<div class="item-pic">
																<a href="#" class="J_MakePoint"> 
																	<img th:src="@{${order2.commodity.getImgUrl()}}" class="itempic J_ItemImg">
																</a>
															</div>
															<div class="item-info">
																<div class="item-basic-info">
																	<a href="#">
																		<p th:text="${order2.commodity.getProductName()}">美康粉黛醉美唇膏 持久保湿滋润防水不掉色</p>
																		<p class="info-little">
																			颜色：随机<br />包装：裸装
																		</p>
																	</a>
																</div>
															</div>
														</li>
														<li class="td td-price">
															<div class="item-price" th:text="'￥'+${order2.commodity.getPrice()}">333.00</div>
														</li>
														<li class="td td-number">
															<div class="item-number">
																<span th:text="${order2.count}"></span>
															</div>
														</li>
														<li class="td td-operation">
															<div class="item-operation">
																<a href="refund.html">退款/退货</a>
															</div>
														</li>
													</ul>

												</div>
												<div class="order-right">
													<li class="td td-amount">
														<div class="item-amount" th:text="'合计：'+${order2.total_fee}">
															合计：676.00
														</div>
													</li>
													<div class="move-right">
														<li class="td td-status">
															<div class="item-status">
																<p class="Mystatus">卖家已发货</p>
															</div>
														</li>
														<li class="td td-change">
															<div class="am-btn am-btn-danger anniu" id="comfire">确认收货</div>
														</li>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="am-tab-panel am-fade" id="tab5">
								<div class="order-top">
									<div class="th th-item">
										<td class="td-inner">商品</td>
									</div>
									<div class="th th-price">
										<td class="td-inner">单价</td>
									</div>
									<div class="th th-number">
										<td class="td-inner">数量</td>
									</div>
									<div class="th th-operation">
										<td class="td-inner">商品操作</td>
									</div>
									<div class="th th-amount">
										<td class="td-inner">合计</td>
									</div>
									<div class="th th-status">
										<td class="td-inner">交易状态</td>
									</div>
									<div class="th th-change">
										<td class="td-inner">交易操作</td>
									</div>
								</div>

								<div class="order-main" th:each="order3:${received}">
									<div class="order-list">
										<!--不同状态的订单	-->
										<div class="order-status4">
											<div class="order-title">
												<div class="dd-num">
													订单编号：<a href="javascript:;" th:text="${order3.id}">1601430</a>
												</div>
												<span th:text="'成交时间:'+${order3.createDate}">成交时间：2015-12-20</span>

											</div>
											<div class="order-content">
												<div class="order-left">
													<ul class="item-list">
														<li class="td td-item">
															<div class="item-pic">
																<a href="#" class="J_MakePoint"> 
																	<img th:src="@{${order3.commodity.getImgUrl()}}" class="itempic J_ItemImg">
																</a>
															</div>
															<div class="item-info">
																<div class="item-basic-info">
																	<a href="#">
																		<p th:text="${order3.commodity.getProductName()}">美康粉黛醉美唇膏 持久保湿滋润防水不掉色</p>
																		<p class="info-little">
																			颜色：随机 <br />包装：裸装
																		</p>
																	</a>
																</div>
															</div>
														</li>
														<li class="td td-price">
															<div class="item-price" th:text="'￥'+${order3.commodity.getPrice()}">333.00</div>
														</li>
														<li class="td td-number">
															<div class="item-number">
																<span th:text="${order3.count}"></span>
															</div>
														</li>
														<li class="td td-operation">
															<div class="item-operation">
																<a href="refund.html">退款/退货</a>
															</div>
														</li>
													</ul>

												</div>
												<div class="order-right">
													<li class="td td-amount">
														<div class="item-amount" th:text="'合计：'+${order3.total_fee}">
															合计：676.00
														</div>
													</li>
													<div class="move-right">
														<li class="td td-status">
															<div class="item-status">
																<p class="Mystatus">交易成功</p>
															</div>
														</li>
														<li class="td td-change"><a href="commentlist.html">
																<div class="am-btn am-btn-danger anniu">评价商品</div>
														</a></li>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div th:replace="infomenu::infomenu"></div>
	</div>
	<div th:replace="footer::footer"></div>
	<script type="text/javascript">
		$(".delete").on("click",function(){
			var id=$(this).attr("value");
			var a=$(this);
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");					
			$.ajax({
				url:"http://localhost:8081/user/delete_order",
				type:"post",
				headers:{header:token},
				data:{"id":id},
				beforeSend:function(xhr) {
					xhr.setRequestHeader(header,token);
				},
				success:function(data){
					if(typeof(data=="string")){
						alert(data);
						a.parent().parent().parent().parent().parent().parent().parent().parent().remove();
					}
				
				}
			});
		})
		/*一键支付*/
	$("#LikBuy").on("click",function(){
		var count=$("#count").html();
		
		var id=$("#LikBuy").attr("value");
		window.location.href="/user/buy?param="+id+"&count="+count;
	});
		/*确认收货*/
	$("#comfire").on("click",function(){
		var id=$("#orderid").html();
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
		$.ajax({
			url:"http://localhost:8081/user/confirmed",
			type:"post",
			headers:{header:token},
			data:{"id":id},
			beforeSend:function(xhr) {
				xhr.setRequestHeader(header,token);
			},
			success:function(data){
				alert(data);
				window.location.href="http://localhost:8081/user/to_order";
			}
		});
	})
	</script>
</body>
</html>